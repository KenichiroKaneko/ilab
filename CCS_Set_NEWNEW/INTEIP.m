%  ***********************************************************************
%++++ SUBROUTINE (No.3)  INTEIP ++++++++++++++++++++++++++++++++++++++++++
%     通常のGauss積分公式を用いて積分計算を行う。
%  ***********************************************************************
function [HIP] = INTEIP(X1,Y1,X2,Y2,X3,Y3)
%
%//// 通常のGauss積分用のデータ ////////////////////////////////////////
     GI =     [ +0.9894009349D0,-0.9894009349D0,+0.9445750230D0,...
                -0.9445750230D0,+0.8656312023D0,-0.8656312023D0,...
                +0.7554044083D0,-0.7554044083D0,+0.6178762444D0,...
                -0.6178762444D0,+0.4580167776D0,-0.4580167776D0,...
                +0.2816035507D0,-0.2816035507D0,+0.0950125098D0,...
                -0.0950125098D0];
%
     OME =    [ +0.0271524594D0,+0.0271524594D0,+0.0622535239D0,...
                +0.0622535239D0,+0.0951585116D0,+0.0951585116D0,...
                +0.1246289712D0,+0.1246289712D0,+0.1495959888D0,...
                +0.1495959888D0,+0.1691565193D0,+0.1691565193D0,...
                +0.1826034150D0,+0.1826034150D0,+0.1894506104D0,...
                +0.1894506104D0];
%///////////////////////////////////////////////////////////////////////
     HW = zeros(1,3);
     GW = zeros(1,3);
     GR = zeros(1,3);
     GZ = zeros(1,3);
     HR = zeros(1,3);
     HZ = zeros(1,3);
%-----------------------------------------------------------------------
%!% JACOBIANの中身の計算
%! J=[{(X3-2*X2+X1)ξ+(X3-X1)/2}^2+{(Y3-2*Y2+Y1)ξ+(Y3-Y1)}^2]^0.5
%!        A              B             C              D
%
	 A = X3-2.D0.*X2+X1;
	 B = (X3-X1)./2.D0;
	 C = Y3-2.D0.*Y2+Y1;
	 D = (Y3-Y1)./2.D0;
     DELTA1 = zeros(16);
     DELTA2 = zeros(16);
     DELTA3 = zeros(16);
     ZETA1 = zeros(16);
     ZETA2 = zeros(16);
     ZETA3 = zeros(16);
     XCO  = zeros(16);
     YCO  = zeros(16);
     XJA = zeros(16);
%-----------------------------------------------------------------------
%         ! 形状関数δの計算
%         ! DELTA1:δ1=ξ(ξ-1)/2
%         ! DELTA2:δ2=1-ξ^2
%         ! DELTA3:δ3=ξ(ξ+1)/2
%
	     DELTA1(1:16) = 0.5D0*GI(1:16).*(GI(1:16)-1);
	     DELTA2(1:16) = 1.-GI(1:16).^2;
	     DELTA3(1:16) = 0.5D0*GI(1:16).*(GI(1:16)+1);
%-----------------------------------------------------------------------
%         ! 内挿関数ζの計算
%         ! ZETA1:ζ1=(3/4)ξ((3/2)ξ-1) 
%         ! ZETA2:ζ2=(1-(3/2)ξ)*(1+(3/2)ξ)
%         ! ZETA3:ζ3=(3/4)ξ((3/2)ξ+1) 
%
	     ZETA1(1:16) = 0.75D0*GI(1:16).*(1.5D0*GI(1:16)-1); 
	     ZETA2(1:16) = (1-1.5D0*GI(1:16)).*(1+1.5D0*GI(1:16));
	     ZETA3(1:16) = 0.75D0*GI(1:16).*(1.5D0*GI(1:16)+1); 
%-----------------------------------------------------------------------
%         ! XCO,YCO:積分点
%
   	     XCO(1:16) = X1.*DELTA1(1:16)+X2.*DELTA2(1:16)+X3.*DELTA3(1:16);
%	     YCO(1:16) = Y1.*DELTA1(1:16)+Y2.*DELTA2(1:16)+Y3.*DELTA3(1:16);
	     XJA(1:16) = sqrt((GI(1:16).*A+B).^2+(GI(1:16).*C+D).^2);

%-----------------------------------------------------------------------

%
         HIP(1) = sum(ones(1,16)./XCO(1:16).*OME(1:16).*XJA(1:16).*ZETA1(1:16));
	     HIP(2) = sum(ones(1,16)./XCO(1:16).*OME(1:16).*XJA(1:16).*ZETA2(1:16));
	     HIP(3) = sum(ones(1,16)./XCO(1:16).*OME(1:16).*XJA(1:16).*ZETA3(1:16));
         
end