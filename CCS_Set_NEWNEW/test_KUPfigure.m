% KUP = 30
MSE = [-1.000e+00, -1.000e+00, -1.000e+00, -1.000e+00, -1.000e+00, -1.000e+00, 3.457e-03, 3.457e-03, 3.426e-03, 3.426e-03, 3.426e-03, 3.457e-03, 3.426e-03, 3.430e-03, 3.430e-03, 3.430e-03, 3.102e-03, 2.320e-03, 1.211e-03, 1.211e-03, 1.207e-03, 1.207e-03, 1.207e-03, 1.211e-03, 1.211e-03, 1.211e-03, 1.207e-03, 1.203e-03, 1.203e-03, 1.207e-03, 1.206e-03, 1.206e-03, 1.206e-03, 1.206e-03, 1.206e-03, 1.210e-03, 1.210e-03, 1.614e-03, 1.715e-03, 1.715e-03, 1.576e-03, 1.410e-03, 1.410e-03, 9.933e-04, 9.858e-04, 9.858e-04, 9.757e-04, 9.955e-04, 9.955e-04, 9.955e-04, 1.457e-03, 1.781e-03, 1.695e-03, 1.451e-03, 1.244e-03, 1.176e-03, 1.181e-03, 1.164e-03, 1.072e-03, 9.835e-04, 8.761e-04, 8.761e-04, 6.004e-04, 7.391e-04, 7.510e-04, 7.690e-04, 7.690e-04, 8.128e-04, 9.463e-04, 1.545e-03, 1.807e-03, 1.310e-03, 1.342e-03, 1.570e-03, 1.391e-03, 6.247e-04, 2.752e-04, 2.488e-04, 2.339e-04, 2.248e-03, 2.999e-03, 2.948e-03, 2.252e-03, 2.038e-03, 1.225e-03, 1.082e-03, 8.719e-04];
% MSE = load("vars_result_aaUTST_numel_2033R").MSE;
% MSE = load("vars_result_UTST_numel_0600R").MSE;
vars = load("vars_inLcurve");

% 二乗誤差
L = 73;
% MSE = MSE(1:69);

MSEMax = max(MSE);

for i = 1:length(MSE)

    if MSE(i) == -1 & i == 1
        MSE(i) = 1;
    elseif MSE(i) == -1
        MSE(i) = MSE(i - 1);
        MSE(i) = 1;
    end

end

[M, I] = min(MSE)

x = 1:length(MSE);
figure()
hold on

yyaxis left
plot(x, MSE)
xlabel("SVs");
ylabel("MSE");
ylim([0 MSEMax]);

scatter(L, MSE(L), "r*");
scatter(I, MSE(I), "b*");

% 残差
residual = vars.residual;

yyaxis right
plot(x, log10(residual));
ylabel('log(||Ap^* - q||)');
